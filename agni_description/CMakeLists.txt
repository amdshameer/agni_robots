cmake_minimum_required(VERSION 2.8.3)
project(agni_description)
find_package(catkin REQUIRED COMPONENTS urdf xacro)
include_directories(${Boost_INCLUDE_DIR} ${catkin_INCLUDE_DIRS})

catkin_package(
    DEPENDS
    CATKIN_DEPENDS urdf xacro
    INCLUDE_DIRS
    LIBRARIES
)


xacro_add_xacro_file(robots/sfb.urdf.xacro INORDER)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})
xacro_add_xacro_file(robots/famula.urdf.xacro INORDER)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})

# sfb frame
xacro_add_xacro_file(robots/frame.urdf.xacro robots/sfb_frame.urdf INORDER REMAP FRAME:=pa10)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})

# famula frame
xacro_add_xacro_file(robots/frame.urdf.xacro robots/famula_frame.urdf INORDER REMAP FRAME:=kuka)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})

# left right pa10
xacro_add_xacro_file(robots/arms.urdf.xacro robots/right_pa10.urdf INORDER REMAP ARM:=pa10 SIM:=1 SIDE:=right)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})
xacro_add_xacro_file(robots/arms.urdf.xacro robots/left_pa10.urdf INORDER REMAP ARM:=pa10 SIM:=1 SIDE:=left)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})
# left right kuka
xacro_add_xacro_file(robots/arms.urdf.xacro robots/right_kuka.urdf INORDER REMAP ARM:=kuka SIM:=1 SIDE:=right)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})
xacro_add_xacro_file(robots/arms.urdf.xacro robots/left_kuka.urdf INORDER REMAP ARM:=kuka SIM:=1 SIDE:=left)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})

#left right shadow_hand_motor_ubi
xacro_add_xacro_file(robots/shadow_hands.urdf.xacro robots/right_shadow_hand_motor_ubi.urdf INORDER REMAP MODEL:=motor SIDE:=right PREFIX:=rh TACTILE:=ubi)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})
xacro_add_xacro_file(robots/shadow_hands.urdf.xacro robots/left_shadow_hand_motor_ubi.urdf INORDER REMAP MODEL:=motor SIDE:=left PREFIX:=lh TACTILE:=ubi)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})

#left right pa10 shadow_hand_motor_ubi
xacro_add_xacro_file(robots/arms_hands.urdf.xacro robots/right_pa10_shadow_hand_motor_ubi.urdf INORDER REMAP ARM:=pa10 SIM:=1 TACTILE:=ubi HANDMODEL:=motor SIDE:=right)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})
xacro_add_xacro_file(robots/arms_hands.urdf.xacro robots/left_pa10_shadow_hand_motor_ubi.urdf INORDER REMAP ARM:=pa10 SIM:=1 TACTILE:=ubi HANDMODEL:=motor SIDE:=left)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})

#left right kuka shadow_hand_motor_ubi
xacro_add_xacro_file(robots/arms_hands.urdf.xacro robots/right_kuka_shadow_hand_motor_ubi.urdf INORDER REMAP ARM:=kuka SIM:=1 TACTILE:=ubi HANDMODEL:=motor SIDE:=right)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})
xacro_add_xacro_file(robots/arms_hands.urdf.xacro robots/left_kuka_shadow_hand_motor_ubi.urdf INORDER REMAP ARM:=kuka SIM:=1 TACTILE:=ubi HANDMODEL:=motor SIDE:=left)
list(APPEND xacro_outputs ${XACRO_OUTPUT_FILE})

# install the generated files
add_custom_target(xacro ALL DEPENDS ${xacro_outputs})
xacro_install(xacro ${xacro_outputs} DESTINATION robots)


#catkin_add_gtest(test_sr_description_urdf test/test_sr_description_urdf.cpp)
#add_dependencies(test_sr_description_urdf ${catkin_EXPORTED_TARGETS})
#target_link_libraries(test_sr_description_urdf ${Boost_LIBRARIES} ${catkin_LIBRARIES} ${GTEST_LIBRARIES} pthread)

install(DIRECTORY doc/
   DESTINATION ${CATKIN_PACKAGE_SHARE_DESTINATION}/doc)

install(DIRECTORY kuka/
   DESTINATION ${CATKIN_PACKAGE_SHARE_DESTINATION}/kuka)

install(DIRECTORY pa10/
   DESTINATION ${CATKIN_PACKAGE_SHARE_DESTINATION}/pa10)

install(DIRECTORY urdf/
   DESTINATION ${CATKIN_PACKAGE_SHARE_DESTINATION}/urdf)

install(DIRECTORY models/
   DESTINATION ${CATKIN_PACKAGE_SHARE_DESTINATION}/models)

install(DIRECTORY config/
   DESTINATION ${CATKIN_PACKAGE_SHARE_DESTINATION}/config)

install(DIRECTORY calibration/
   DESTINATION ${CATKIN_PACKAGE_SHARE_DESTINATION}/calibration)
   
install(DIRECTORY robots/
   DESTINATION ${CATKIN_PACKAGE_SHARE_DESTINATION}/robots)

install(DIRECTORY launch/
   DESTINATION ${CATKIN_PACKAGE_SHARE_DESTINATION}/launch)
   

#file(GLOB def_files ${CMAKE_CURRENT_SOURCE_DIR}/urdf/*.xacro
#                    ${CMAKE_CURRENT_SOURCE_DIR}/robots/*groups*.xacro)

#file(GLOB xacros ${CMAKE_CURRENT_SOURCE_DIR}/robots/*.urdf.xacro)

#rosbuild_find_ros_package(xacro)

#set(outfiles "")

#foreach( _xacro ${xacros} )
#  string(REPLACE ".urdf." ".expanded." _outfile ${_xacro})
#  add_custom_command(
#    OUTPUT ${_outfile}
#    COMMAND ${xacro_PACKAGE_PATH}/xacro.py
#    ARGS ${_xacro} > ${_outfile}
#    DEPENDS ${_xacro} ${def_files})
#  list(APPEND outfiles ${_outfile})
#endforeach( _xacro)

#add_custom_target( expanded_defs ALL DEPENDS ${outfiles} )
